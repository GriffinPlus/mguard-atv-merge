# mguard-config-tool

[![Build Status](https://dev.azure.com/griffinplus/mGuard-Config-Tool/_apis/build/status/mguard-config-tool?branchName=master)](https://dev.azure.com/griffinplus/mGuard-Config-Tool/_build/latest?definitionId=16&branchName=master)
[![Release](https://img.shields.io/github/release/griffinplus/mguard-config-tool.svg?logo=github)](https://github.com/GriffinPlus/mguard-config-tool/releases)

-----

## Status

**This project is under active development and should not be used in production, yet.**

-----

## Overview and Motivation

The *mGuard* security router series is a family of firewall/router devices that is produced by the PHOENIX CONTACT
Cyber Security AG, a member of the [PHOENIX CONTACT group](https://www.phoenixcontact.com/). An *mGuard* in connection
with the [mGuard Secure Cloud](https://us.cloud.mguard.com/) can be used for remote servicing machines in the field
via IPSec-VPN.

Setting up an *mGuard* in the *mGuard Secure Cloud* generates a configuration file containing everything that is needed
to connect to the cloud. The configuration file can then be loaded into the *mGuard* to set it up properly. As a
configuration file is a snapshot of all settings, loading a configuration file replaces existing settings in the
*mGuard*. Therefore it is not possible to have custom settings along with the configuration file generated by the
cloud. A tool that is able to merge two configurations into one would be handy. This is where the *mGuard-Config-Tool*
comes into play.

The *mGuard-Config-Tool* aims to ease handling *mGuard* configuration files. It's main features are:

- Support for ATV files and (unencrypted) ECS containers
- Tasks
  - Conditioning: Condition a configuration and convert formats (ATV <=> ECS)
  - Merging: Merge two configurations into one

## Releases

*mGuard-Config-Tool* is written in GO which makes it highly portable.

[Downloads](https://github.com/GriffinPlus/mguard-config-tool/releases) are provided for the following combinations of
popular target operating systems and platforms:

- Linux
  - Intel x86 Platform (`386`)
  - Intel x64 Platform (`amd64`)
  - ARM 32-bit Platform (`arm`)
  - ARM 64-bit Platform (`arm64`)
- Windows
  - Intel x86 Platform (`386`)
  - Intel x64 Platform (`amd64`)

If any other target operating system and/or platform is needed and the combination is supported by GO, please open an
issue and we'll add support for it.

## Usage

The *mGuard-Config-Tool* is a console application that uses subcommands to run different tasks. The application writes
log messages to *stderr*, so it's easy to pipe them into a log file or discard them entirely. The *stdout* channel is
used for emitting content only.

### Subcommand: condition

The `condition` subcommand provides access to conditioning and conversion tasks. The task takes a configuration file
in ATV format or an ECS container, parses the configuration and saves the configuration to some other ATV file or ECS
container. If an ATV file is specified and an ATV file is written (`--out-atv-file`), the configuration is conditioned
only. If an ATV file is specified and an ECS container is written (`--out-ecs-file`), the conditioned ATV file is
stored in the ECS container and the missing parts in the ECS container are initialized with defaults. The defaults are
the same that an mGuard comes with after factory reset. If an ECS container is specified and an ATV file is written,
the configuration stored in the ECS container is simply extracted and saved as an ATV file. If neither `--out-atv-file`
nor `--out-ecs-file` is specified the configuration is printed in ATV format to *stdout*.

Example:

```
condition - Condition and/or convert a mGuard configuration file.

  Usage:
	condition [file]

  Positional Variables: 
	file   File containing the mGuard configuration to condition (ATV format or ECS container). (Required)

  Flags: 
       --version        Displays the program version string.
    -h --help           Displays help with available flag, subcommand, and positional value parameters.
       --out-atv-file   File receiving the conditioned configuration (ATV format).
       --out-ecs-file   File receiving the conditioned configuration (ECS container).
       --verbose        Include additional messages that might help when problems occur. (default: false)
```

### Subcommand: merge

TODO

## Issues and Contributions

As *mGuard-Config-Tool* is **not** a project of PHOENIX CONTACT, please don't request help for it there!

If you encounter problems using *mGuard-Config-Tool*, please file an [issue](https://github.com/GriffinPlus/mguard-config-tool/issues).

If you have an idea on how to improve *mGuard-Config-Tool*, please also file an [issue](https://github.com/GriffinPlus/mguard-config-tool/issues).
Pull requests are also very appreciated. In case of major changes, please open an issue before to discuss the changes.
This helps to coordinate development and avoids wasting time.
